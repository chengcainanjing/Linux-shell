
{"template":"{\"_source\": { {{#is_includes}} \"includes\": {{#toJson}}includes{{/toJson}}{{#is_excludes}},{{/is_excludes}} {{/is_includes}}  {{#is_excludes}} \"excludes\": {{#toJson}}excludes{{/toJson}}  {{/is_excludes}}  },\"query\":{\"function_score\":{\"query\":{\"bool\":{\"filter\":{} {{#enter_time_start}}{{#enter_time_end}},\"filter\":{\"range\":{\"enter_time\":{\"gte\":\"{{enter_time_start}}\",\"lte\":\"{{enter_time_end}}\",\"format\":\"yyyy-MM-dd HH:mm:ss\",\"time_zone\": \"+08:00\"}}}{{/enter_time_end}}{{/enter_time_start}}{{#person_id}},\"filter\":{\"term\":{\"person_id\":\"{{person_id}}\"}}{{/person_id}}{{#camera_name}},\"filter\":{\"term\":{\"camera_name\":\"{{camera_name}}\"}}{{/camera_name}}{{#camera_type}},\"filter\":{\"term\":{\"camera_type\":{{camera_type}}}}{{/camera_type}}{{#gps_xy}},\"filter\":{\"geo_distance\":{\"distance\":\"{{distance}}\",\"gps_xy\":\"{{gps_xy}}\"}}{{/gps_xy}}{{#office_name}},\"filter\":{\"term\":{\"office_name\":\"{{office_name}}\"}}{{/office_name}}{{#age_start}}{{#age_end}},\"filter\":{\"range\":{\"age\":{\"gte\":\"{{age_start}}\",\"lte\":\"{{age_end}}\"}}}{{/age_end}}{{/age_start}}{{#gender}},\"filter\":{\"term\":{\"gender\":{{gender}}}}{{/gender}}{{#glass}},\"filter\":{\"term\":{\"glass\":{{glass}}}}{{/glass}}{{#mask}},\"filter\":{\"term\":{\"mask\":{{mask}}}}{{/mask}}{{#race}},\"filter\":{\"term\":{\"race\":{{race}}}}{{/race}}{{#beard}},\"filter\":{\"term\":{\"beard\":{{beard}}}}{{/beard}}{{#emotion}},\"filter\":{\"term\":{\"emotion\":{{emotion}}}}{{/emotion}}{{#eye_open}},\"filter\":{\"term\":{\"eye_open\":{{eye_open}}}}{{/eye_open}}{{#mouth_open}},\"filter\":{\"term\":{\"mouth_open\":{{mouth_open}}}}{{/mouth_open}}{{#is_office}},\"filter\":{\"bool\":{\"should\":{\"terms\":{\"office_id\":{{#toJson}}office_id{{/toJson}}}}}}{{/is_office}}{{#is_lib}},\"filter\":{\"bool\":{\"should\":{\"terms\":{\"lib_id\":{{#toJson}}lib_id{{/toJson}}}}}}{{/is_lib}}{{#is_camera}},\"filter\":{\"bool\":{\"should\":{\"terms\":{\"camera_id\":{{#toJson}}camera_id{{/toJson}}}}}}{{/is_camera}}}}{{#is_calcSim}},\"script_score\":{\"script\":{\"lang\":\"native\",\"inline\":\"feature-comp\",\"params\":{\"featureName\":\"{{feature_name}}\",\"filterType\":\"{{filter_type}}\",\"featureValue\":[\"{{#feature_value}}\",\"{{.}}\",\"{{/feature_value}}\"]}}},\"min_score\":{{sim_threshold}}{{/is_calcSim}}}},\"from\":{{from}},\"size\":{{size}},\"sort\":[{{#sortField}}{{#sortOrder}}{\"{{sortField}}\":{\"order\":\"{{sortOrder}}\"}},{{/sortOrder}}{{/sortField}}\"_score\"]}"}
