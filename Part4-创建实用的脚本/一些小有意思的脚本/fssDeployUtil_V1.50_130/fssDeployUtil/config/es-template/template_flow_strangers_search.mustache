
{"template":"{\"query\":{\"bool\":{\"filter\":[{}{{#person_id}},{\"term\":{\"person_id\":\"{{person_id}}\"}}{{/person_id}}{{#start_time}}{{#end_time}},{\"range\":{\"enter_time\":{\"gte\":\"{{start_time}}\",\"lte\":\"{{end_time}}\",\"format\":\"yyyy-MM-dd HH:mm:ss\",\"time_zone\":\"+08:00\"}}}{{/end_time}}{{/start_time}}]{{#is_office}},\"filter\":{\"bool\":{\"should\":{\"terms\":{\"office_id\":{{#toJson}}office_id{{/toJson}}}}}}{{/is_office}}{{#is_camera}},\"filter\":{\"bool\":{\"should\":{\"terms\":{\"camera_id\":{{#toJson}}camera_id{{/toJson}}}}}}{{/is_camera}}}},\"aggregations\":{\"camera_ids\":{\"terms\":{\"field\":\"camera_id\",\"size\":\"{{camera_numbers}}{{^camera_numbers}}10{{/camera_numbers}}\"}{{#time_query}}{{#time_query}},{{/time_query}}\"aggregations\":{\"camera_name\":{\"terms\":{\"field\":\"camera_name\"}},\"camera_type\":{\"terms\":{\"field\":\"camera_type\"}},\"group_by_time\":{\"date_histogram\":{\"field\":\"enter_time\",\"format\":\"yyyy-MM-dd HH:mm:ss\",\"time_zone\":\"+08:00\",\"interval\":\"{{search_interval}}\",\"min_doc_count\":0,\"extended_bounds\":{\"min\":\"{{start_time}}\",\"max\":\"{{end_time}}\"},\"order\":{\"_key\":\"{{order_type}}\"}}{{^age_query}}{{#gender_query}}{{#gender_query}},{{/gender_query}}\"aggregations\":{\"group_by_gender\":{\"terms\":{\"field\":\"gender\"}}}{{/gender_query}}{{/age_query}}{{#age_query}}{{#age_query}},{{/age_query}}\"aggregations\":{\"group_by_age\":{\"range\":{\"field\":\"age\",\"keyed\":true,\"ranges\":[{\"key\":\"child\",\"from\":{{{child_start_age}}},\"to\":{{{child_end_age}}}},{\"key\":\"teenage\",\"from\":{{{teenage_start_age}}},\"to\":{{{teenage_end_age}}}},{\"key\":\"youth\",\"from\":{{{youth_start_age}}},\"to\":{{{youth_end_age}}}},{\"key\":\"midlife\",\"from\":{{{midlife_start_age}}},\"to\":{{{midlife_end_age}}}},{\"key\":\"old\",\"from\":{{{old_start_age}}},\"to\":{{{old_end_age}}}},{\"key\":\"others\",\"from\":{{{others_start_age}}}}]}}{{#gender_query}}{{#gender_query}},{{/gender_query}}\"group_by_gender\":{\"terms\":{\"field\":\"gender\"}}{{/gender_query}}}{{/age_query}}}}{{/time_query}}}},\"from\":{{from}},\"size\":{{size}}}"}



